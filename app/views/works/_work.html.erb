<%# app/views/works/_work.html.erb %>
<div id="<%= dom_id(work) %>" class="card mb-3 shadow-sm">
  <div class="card-body">
    <div class="d-flex justify-content-between align-items-start mb-2">
      <h5 class="card-title mb-0">
        <%= work.nombre.presence || "Trabajo sin título" %>
      </h5>
      <span class="badge text-bg-light">
        <i class="bi bi-calendar-event"></i>
        <%= work.fecha&.strftime("%d-%m-%Y") || "Sin fecha" %>
      </span>
    </div>

    <div class="row gy-2">
      <div class="col-md-3">
        <div class="small text-muted">Planta</div>
        <div class="fw-semibold"><%= work.planta %></div>
      </div>
      <div class="col-md-3">
        <div class="small text-muted">N° Cotización</div>
        <div class="fw-semibold"><%= work.numero_cotizacion %></div>
      </div>
      <div class="col-md-3">
        <div class="small text-muted">Solicita</div>
        <div class="fw-semibold"><%= work.solicita %></div>
      </div>
      <div class="col-md-3">
        <div class="small text-muted">Supervisor</div>
        <div class="fw-semibold"><%= work.supervisor %></div>
      </div>

      <div class="col-md-3">
        <div class="small text-muted">Hora inicio</div>
        <div class="fw-semibold">
          <%= work.hora_inicio&.strftime("%H:%M") %>
        </div>
      </div>
      <div class="col-md-3">
        <div class="small text-muted">Hora término</div>
        <div class="fw-semibold">
          <%= work.hora_termino&.strftime("%H:%M") %>
        </div>
      </div>
    </div>

    <hr class="my-3">

    <div class="row gy-3">
      <div class="col-12">
        <div class="small text-muted">Seguridad y medio ambiente</div>
        <div><%= simple_format(work.seguridad) %></div>
      </div>
      <div class="col-12">
        <div class="small text-muted">Descripción del trabajo</div>
        <div><%= simple_format(work.descripcion) %></div>
      </div>
      <div class="col-12">
        <div class="small text-muted">Personal</div>
        <div><%= simple_format(work.personal) %></div>
      </div>
    </div>

    <hr class="my-3">

    <div>
      <p class="mb-2 fw-semibold">Registro fotográfico</p>

      <% if work.fotos.attached? %>
        <div class="d-flex flex-wrap gap-3">
          <% work.fotos.each do |foto| %>
            <div class="border rounded p-1">
              <%= image_tag foto.variant(resize_to_limit: [800, 800]).processed,
                            class: "img-fluid rounded" %>
            </div>
          <% end %>
        </div>
      <% else %>
        <p class="text-muted mb-0">Sin fotos</p>
      <% end %>
    </div>

    <%# Acciones opcionales (sólo si estás en index) %>
    <div class="mt-3 d-flex gap-2">
      <%= link_to "Ver", work, class: "btn btn-sm btn-outline-primary" %>
      <%= link_to "Editar", edit_work_path(work), class: "btn btn-sm btn-outline-secondary" %>
      <%= link_to "Eliminar",
                  work,
                  data: { turbo_method: :delete, turbo_confirm: "¿Eliminar este trabajo?" },
                  class: "btn btn-sm btn-outline-danger" %>
    </div>
  </div>
</div>
